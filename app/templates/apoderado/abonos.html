{% extends "base.html" %}

{% block page_header -%}
<div class="page-header d-print-none text-white">
  <div class="container">
    <div class="row align-items-center">
      <div class="col">
        <h1 class="fw-bold m-0">Abonos</h1>
      </div>

      <div class="col-auto ms-auto">
        <div class="btn-list">

          <a href="#" class="btn btn-success btn-3" data-bs-toggle="modal" data-bs-target="#modal-abono" aria-label="Nuevo Abono">

            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-credit-card-pay">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M12 19h-6a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v4.5" />
              <path d="M3 10h18" />
              <path d="M16 19h6" />
              <path d="M19 16l3 3l-3 3" />
              <path d="M7.005 15h.005" />
              <path d="M11 15h2" />
            </svg>
            Abonar
          </a>


        </div>
      </div>
    </div>
  </div>
</div>
</div>
{% endblock page_header -%}


{% block page_body %}

<div class="container-xl">
  <div class="row g-3">
    <div class="col">
      <ul class="timeline">
        {% for abono in current_user.apoderado.abonos %}
        <li class="timeline-event">
          <div class="timeline-event-icon bg-x-lt">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-credit-card-pay">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M12 19h-6a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v4.5" />
              <path d="M3 10h18" />
              <path d="M16 19h6" />
              <path d="M19 16l3 3l-3 3" />
              <path d="M7.005 15h.005" />
              <path d="M11 15h2" />
            </svg>
          </div>
          <div class="card timeline-event-card">
            <div class="card-body">
              <div class="text-secondary float-end">{{ abono.created }}</div>
              <a href="{{ url_for(".abono_detalle", codigo=abono.codigo) }}" class="h4 link">{{ abono.descripcion }} {{ abono.codigo }}</a>
              <p class="text-secondary">${{ "{:,.0f}".format(abono.monto) | replace(",", ".") }}</p>
            </div>
          </div>
        </li>
        {% endfor %}
        <li class="timeline-event">
          <div class="timeline-event-icon bg-x-lt">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-sparkles-2">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M13 7a9.3 9.3 0 0 0 1.516 -.546c.911 -.438 1.494 -1.015 1.937 -1.932c.207 -.428 .382 -.928 .547 -1.522c.165 .595 .34 1.095 .547 1.521c.443 .918 1.026 1.495 1.937 1.933c.426 .205 .925 .38 1.516 .546a9.3 9.3 0 0 0 -1.516 .547c-.911 .438 -1.494 1.015 -1.937 1.932a9 9 0 0 0 -.547 1.521c-.165 -.594 -.34 -1.095 -.547 -1.521c-.443 -.918 -1.026 -1.494 -1.937 -1.932a9 9 0 0 0 -1.516 -.547" />
              <path d="M3 14a21 21 0 0 0 1.652 -.532c2.542 -.953 3.853 -2.238 4.816 -4.806a20 20 0 0 0 .532 -1.662a20 20 0 0 0 .532 1.662c.963 2.567 2.275 3.853 4.816 4.806q .75 .28 1.652 .532a21 21 0 0 0 -1.652 .532c-2.542 .953 -3.854 2.238 -4.816 4.806a20 20 0 0 0 -.532 1.662a20 20 0 0 0 -.532 -1.662c-.963 -2.568 -2.275 -3.853 -4.816 -4.806a21 21 0 0 0 -1.652 -.532" />
            </svg>
          </div>
          <div class="card timeline-event-card">
            <div class="card-body">
              <div class="text-secondary float-end">{{ current_user.apoderado.created }}</div>
              <h4>Creacion de Cuenta</h4>
              <p class="text-secondary"></p>
            </div>
          </div>
        </li>

      </ul>
    </div>
  </div>
</div>
<div class="modal modal-blur fade" id="modal-abono" tabindex="-1" role="dialog" aria-hidden="true">
  <form action="." method="post" class="needs-validation" novalidate>
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Nuevo Abono</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label required">Monto</label>
            <input type="number" class="form-control" name="example-text-input" placeholder="2000" min="2000" max="100000" required />
            <small class="form-hint">Mínimo: <strong>$2.000</strong> - Máximo: <strong>$100.000</strong></small>
          </div>
          <label class="form-label required">Forma de Pago</label>
          <div class="form-selectgroup-boxes row mb-3">
            <div class="col-lg-6">
              <label class="form-selectgroup-item">
                <input type="radio" name="forma-de-pago" value="khipu" class="form-selectgroup-input" />
                <span class="form-selectgroup-label d-flex align-items-center p-3">
                  <span class="me-3">
                    <span class="form-selectgroup-check"></span>
                  </span>
                  <span class="form-selectgroup-label-content">
                    <span class="form-selectgroup-title strong mb-1">Transferencia Electrónica</span>
                    <span class="d-block text-secondary">Validación automática de abonos, procesado por Khipu</span>
                  </span>
                </span>
              </label>
            </div>
            <div class="col-lg-6">
              <label class="form-selectgroup-item">
                <input type="radio" name="forma-de-pago" value="cafeteria" class="form-selectgroup-input" checked />
                <span class="form-selectgroup-label d-flex align-items-center p-3">
                  <span class="me-3">
                    <span class="form-selectgroup-check"></span>
                  </span>
                  <span class="form-selectgroup-label-content">
                    <span class="form-selectgroup-title strong mb-1">Efectivo/Tarjetas</span>
                    <span class="d-block text-secondary">Presencialmente en la Cafeteria del colegio</span>
                  </span>
                </span>
              </label>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <a href="#" class="btn btn-link link-secondary btn-3" data-bs-dismiss="modal"> Cancelar </a>
          <button type="submit" class="btn btn-primary btn-5 ms-auto"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false" class="icon icon-2">
              <path d="M12 5l0 14" />
              <path d="M5 12l14 0" />
            </svg>
            Pagar Abono
          </button>
        </div>
      </div>
    </div>
  </form>
</div>
{% endblock page_body %}

{% block page_scripts %}
<script>
  const form = document.querySelector('.needs-validation');

  form.addEventListener('submit', (e) => {
    if (!form.checkValidity()) {
      e.preventDefault();
      e.stopPropagation();
    }

    form.classList.add('was-validated');
  }, false);
</script>
{% endblock page_scripts%}
